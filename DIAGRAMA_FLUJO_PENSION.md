# Diagrama de Flujo: DiagnÃ³stico de PensiÃ³n IMSS

## Arquitectura del Sistema RAG + Agente

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ARQUITECTURA RAG + AGENTE                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   USUARIO    â”‚â”€â”€â”€â”€â–¶â”‚  AGENTE IA   â”‚â”€â”€â”€â”€â–¶â”‚  BASE CONOCIMIENTO   â”‚   â”‚
â”‚  â”‚  (Voz/Texto) â”‚     â”‚  (LLM + CoT) â”‚     â”‚  (RAG + Vectores)    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â”‚                        â”‚                 â”‚
â”‚                              â”‚ Function Calling       â”‚ Retrieval       â”‚
â”‚                              â–¼                        â–¼                 â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚                    â”‚  CALCULADORA     â”‚    â”‚   DOCUMENTOS         â”‚   â”‚
â”‚                    â”‚  FISCAL          â”‚    â”‚   - LSS 1973/1997    â”‚   â”‚
â”‚                    â”‚  (PrecisiÃ³n 100%)â”‚    â”‚   - Cuotas IMSS      â”‚   â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚   - UMA vigente      â”‚   â”‚
â”‚                              â”‚              â”‚   - Casos ejemplo    â”‚   â”‚
â”‚                              â–¼              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                â”‚
â”‚                    â”‚   RESPUESTA      â”‚                                â”‚
â”‚                    â”‚   ESTRUCTURADA   â”‚                                â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Flujo de DiagnÃ³stico de PensiÃ³n

```
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚     INICIO      â”‚
                              â”‚  "Hola, soy tu  â”‚
                              â”‚  asesor IMSS"   â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                                       â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   PASO 1: RÃ‰GIMEN DE LEY            â”‚
                    â”‚   "Â¿En quÃ© aÃ±o comenzaste a         â”‚
                    â”‚    cotizar al IMSS?"                â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚                           â”‚
                     â–¼                           â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  ANTES 1997    â”‚         â”‚  DESPUÃ‰S 1997  â”‚
            â”‚   LEY 73       â”‚         â”‚    LEY 97      â”‚
            â”‚  âœ“ PensiÃ³n     â”‚         â”‚  âœ“ AFORE       â”‚
            â”‚    vitalicia   â”‚         â”‚  âœ“ Cuenta      â”‚
            â”‚  âœ“ Mod 40      â”‚         â”‚    individual  â”‚
            â”‚    recomendada â”‚         â”‚                â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚                          â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   PASO 2: SEMANAS COTIZADAS         â”‚
                    â”‚   "Â¿CuÃ¡ntas semanas tienes          â”‚
                    â”‚    reconocidas?"                    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚                    â”‚                    â”‚
              â–¼                    â–¼                    â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚   < 500        â”‚  â”‚  500 - 1000    â”‚  â”‚   > 1000       â”‚
     â”‚   SEMANAS      â”‚  â”‚   SEMANAS      â”‚  â”‚   SEMANAS      â”‚
     â”‚                â”‚  â”‚                â”‚  â”‚                â”‚
     â”‚ âš ï¸ No cumple   â”‚  â”‚ âœ“ Cumple       â”‚  â”‚ âœ“ Excelente    â”‚
     â”‚   mÃ­nimo para  â”‚  â”‚   mÃ­nimo       â”‚  â”‚   posiciÃ³n     â”‚
     â”‚   pensiÃ³n      â”‚  â”‚   Ley 73       â”‚  â”‚   pensionaria  â”‚
     â”‚                â”‚  â”‚                â”‚  â”‚                â”‚
     â”‚ Mod 40 puede   â”‚  â”‚ Puede mejorar  â”‚  â”‚ Maximizar      â”‚
     â”‚ completar      â”‚  â”‚ con mÃ¡s        â”‚  â”‚ salario        â”‚
     â”‚ semanas        â”‚  â”‚ semanas        â”‚  â”‚ promedio       â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚                   â”‚                   â”‚
             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   PASO 3: SITUACIÃ“N LABORAL         â”‚
                    â”‚   "Â¿Actualmente tienes patrÃ³n       â”‚
                    â”‚    que te cotiza?"                  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚                           â”‚
                     â–¼                           â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  SÃ - ACTIVO   â”‚         â”‚  NO - BAJA     â”‚
            â”‚                â”‚         â”‚                â”‚
            â”‚ âŒ No puede    â”‚         â”‚ âœ“ CANDIDATO    â”‚
            â”‚    inscribirse â”‚         â”‚   MODALIDAD 40 â”‚
            â”‚    en Mod 40   â”‚         â”‚                â”‚
            â”‚                â”‚         â”‚ Puede mejorar  â”‚
            â”‚ Sigue cotizandoâ”‚         â”‚ pensiÃ³n        â”‚
            â”‚ normalmente    â”‚         â”‚ voluntariamenteâ”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚                          â”‚
                    â”‚                          â–¼
                    â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚         â”‚   PASO 4: SALARIO          â”‚
                    â”‚         â”‚   "Â¿CuÃ¡l era tu salario    â”‚
                    â”‚         â”‚    mensual?"               â”‚
                    â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚                       â”‚
                    â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚         â”‚                           â”‚
                    â”‚         â–¼                           â–¼
                    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  â”‚  < $50,000/mes â”‚       â”‚  > $50,000/mes â”‚
                    â”‚  â”‚                â”‚       â”‚                â”‚
                    â”‚  â”‚ Considerar     â”‚       â”‚ Puede topar    â”‚
                    â”‚  â”‚ registrar      â”‚       â”‚ en 25 UMAs     â”‚
                    â”‚  â”‚ salario mayor  â”‚       â”‚ ($84,855/mes)  â”‚
                    â”‚  â”‚ para mejorar   â”‚       â”‚                â”‚
                    â”‚  â”‚ pensiÃ³n        â”‚       â”‚ MÃ¡ximo         â”‚
                    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚ beneficio      â”‚
                    â”‚          â”‚                â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                    â”‚                                   â”‚
                    â”‚                                   â–¼
                    â”‚                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                  â”‚   PASO 5: FECHA NACIMIENTO â”‚
                    â”‚                  â”‚   "Â¿CuÃ¡l es tu fecha       â”‚
                    â”‚                  â”‚    de nacimiento?"         â”‚
                    â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚                                â”‚
                    â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚              â”‚                 â”‚                 â”‚
                    â”‚              â–¼                 â–¼                 â–¼
                    â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚     â”‚  < 55 aÃ±os   â”‚  â”‚  55-59 aÃ±os  â”‚  â”‚  60+ aÃ±os    â”‚
                    â”‚     â”‚              â”‚  â”‚              â”‚  â”‚              â”‚
                    â”‚     â”‚ Tiempo para  â”‚  â”‚ Urgente      â”‚  â”‚ Â¡Ya puede    â”‚
                    â”‚     â”‚ planificar   â”‚  â”‚ inscribirse  â”‚  â”‚ jubilarse!   â”‚
                    â”‚     â”‚              â”‚  â”‚ antes de 60  â”‚  â”‚              â”‚
                    â”‚     â”‚ Estrategia   â”‚  â”‚              â”‚  â”‚ DecisiÃ³n     â”‚
                    â”‚     â”‚ a largo      â”‚  â”‚ Maximizar    â”‚  â”‚ inmediata    â”‚
                    â”‚     â”‚ plazo        â”‚  â”‚ Ãºltimos aÃ±os â”‚  â”‚              â”‚
                    â”‚     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚            â”‚                 â”‚                 â”‚
                    â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚                              â”‚
                    â”‚                              â–¼
                    â”‚                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                 â”‚   PASO 6: EDAD DE RETIRO    â”‚
                    â”‚                 â”‚   "Â¿A quÃ© edad quieres      â”‚
                    â”‚                 â”‚    jubilarte?"              â”‚
                    â”‚                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚                                â”‚
                    â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚    â”‚         â”‚         â”‚       â”‚       â”‚         â”‚         â”‚
                    â”‚    â–¼         â–¼         â–¼       â–¼       â–¼         â–¼         â–¼
                    â”‚  60 aÃ±os  61 aÃ±os  62 aÃ±os  63 aÃ±os  64 aÃ±os  65 aÃ±os
                    â”‚   75%      80%      85%      90%      95%     100%
                    â”‚                                â”‚
                    â”‚                                â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                                                     â”‚
                                                     â–¼
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚         CÃLCULO FINAL               â”‚
                              â”‚   (Function Calling a Calculadora)  â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                             â”‚
                                             â–¼
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚         RESULTADOS                  â”‚
                              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                              â”‚                                     â”‚
                              â”‚  ğŸ“Š CUOTA MODALIDAD 40              â”‚
                              â”‚     â””â”€ Pago mensual: $X,XXX         â”‚
                              â”‚     â””â”€ InversiÃ³n total: $XXX,XXX    â”‚
                              â”‚                                     â”‚
                              â”‚  ğŸ¯ PENSIÃ“N ESTIMADA                â”‚
                              â”‚     â””â”€ Mensual: $XX,XXX             â”‚
                              â”‚     â””â”€ Anual: $XXX,XXX              â”‚
                              â”‚                                     â”‚
                              â”‚  ğŸ“ˆ ANÃLISIS ROI                    â”‚
                              â”‚     â””â”€ RecuperaciÃ³n: X meses        â”‚
                              â”‚     â””â”€ Rendimiento: XX%             â”‚
                              â”‚                                     â”‚
                              â”‚  ğŸ“š FUNDAMENTO LEGAL                â”‚
                              â”‚     â””â”€ Art. 218 LSS                 â”‚
                              â”‚     â””â”€ Art. 143 LSS                 â”‚
                              â”‚                                     â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Reglas de Negocio Implementadas

### Validaciones CrÃ­ticas

| Regla | CondiciÃ³n | AcciÃ³n |
|-------|-----------|--------|
| Elegibilidad Mod 40 | Sin patrÃ³n activo | Permitir inscripciÃ³n |
| Semanas mÃ­nimas | >= 52 en Ãºltimos 5 aÃ±os | Validar antes de calcular |
| Edad mÃ¡xima inscripciÃ³n | < 60 aÃ±os | Alertar si no cumple |
| Tope salarial | <= 25 UMAs ($84,855) | Limitar automÃ¡ticamente |
| Semanas para pensiÃ³n | >= 500 | Informar faltantes |

### FÃ³rmulas Implementadas

```javascript
// Cuota mensual Modalidad 40
cuotaMensual = salarioMensual * 0.10075

// Porcentaje por semanas (Ley 73)
if (semanas <= 500) porcentaje = 0
if (semanas 500-1000) porcentaje = (semanas-500)/52 * 1.25
if (semanas 1000-1250) porcentaje = 12.019 + (semanas-1000)/52 * 1.50
if (semanas 1250-1500) porcentaje = 19.231 + (semanas-1250)/52 * 1.75
if (semanas > 1500) porcentaje = 27.404 + (semanas-1500)/52 * 2.00

// PensiÃ³n estimada
pensionBase = salarioPromedio5AÃ±os * (porcentajeSemanas/100)
pensionFinal = pensionBase * factorEdad[edadRetiro]
```

---

## Capas de InformaciÃ³n (RAG)

### 1. Capa Legal (PDF â†’ Vectores)
```
knowledge-base/
â””â”€â”€ legal/
    â”œâ”€â”€ ley_seguro_social_73.pdf
    â”œâ”€â”€ ley_seguro_social_97.pdf
    â”œâ”€â”€ reglamento_afiliacion.pdf
    â””â”€â”€ acuerdos_junta_directiva/
```

### 2. Capa Operativa (JSON/CSV)
```
knowledge-base/
â””â”€â”€ operativa/
    â”œâ”€â”€ cuotas-imss-2025.json     âœ“ Implementado
    â”œâ”€â”€ uma_historico.csv
    â””â”€â”€ tablas_actuariales.json
```

### 3. Capa de Casos (Few-Shot)
```
knowledge-base/
â””â”€â”€ casos/
    â”œâ”€â”€ caso_ley73_900semanas.json
    â”œâ”€â”€ caso_ley73_cerca_jubilacion.json
    â”œâ”€â”€ caso_comparativo_ley73_vs_97.json
    â””â”€â”€ caso_mod40_5_aÃ±os.json
```

---

## Endpoints API Implementados

| Endpoint | MÃ©todo | PropÃ³sito |
|----------|--------|-----------|
| `/api/calcular` | POST | CÃ¡lculo de pensiÃ³n |
| `/api/rag/buscar` | POST | BÃºsqueda en base legal |
| `/api/rag/articulo/:key` | GET | Obtener artÃ­culo especÃ­fico |
| `/api/rag/faqs` | GET | Preguntas frecuentes |
| `/api/agente/flujo` | GET | Flujo de diagnÃ³stico |
| `/api/agente/chat` | POST | Chat con contexto |
| `/api/datos-referencia` | GET | UMA, topes, factores |
| `/api/tabla-semanas` | GET | Tabla de porcentajes |
| `/api/ley` | GET | ArtÃ­culos de ley |

---

## PrÃ³ximos Pasos Recomendados

1. **Integrar LLM real** (GPT-4, Claude) para respuestas mÃ¡s naturales
2. **AÃ±adir embeddings** con sentence-transformers para bÃºsqueda semÃ¡ntica
3. **Subir PDFs reales** de la Ley del Seguro Social
4. **Conectar con AFORE** para obtener saldos reales (API CONSAR)
5. **Integrar voz** para CallCenteria (whisper + TTS)
